<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>First laboratory</title>
	<!-- <link rel="stylesheet" href="styles/reset.css"> -->
	<link rel="stylesheet" href="styles/main.css">
</head>
<body>
	<header style="text-align: center">
		<h1>Лабораторная работа №1</h1>
	</header>

	<main>
		<ul>
			<li>
				<h2>Задачи работы</h2>
				<ol>
					<li>1. Для полученной модели временного ряда из лабораторной работы 1 вычислить остатки.</li>
					<li>2. Провести анализ временного ряда остатков на стационарность. В случае нестационарности определить порядок интегрирования <span class="math">(r)</span> временного ряда.</li>
					<li>3. Построить <span class="math">ARMA(p,q,r)</span> модель по методики <i>Бокса-Дженкинса</i>.</li>
					<li>4. Провести анализ стационарности временного ряда полученных остатков.</li>
				</ol>
			</li>
			<li>
				<h2>Ход работы</h2>
				<ol>
					<li>
						<h3>1. Вычисление остатков</h3>
						<div id="plot-leftover" class="plot"></div>
						<p>График остатков иллюстрирует влияние случайных событий на стоимость продукта.</p>
					</li>
					<li>
						<h3>2. Анализ стационарности временного ряда остатков</h3>
						<p>Графики автокорреляционной функции и частной автокорреляционной функции имеют вид:</p>
						<div class="plot" id="plot-autocorellation"></div>
						<div class="plot" id="plot-autocorellation-partial"></div>
						<p>По данным графикам можно предположить о существенной зависимости текущего значения ряда остатков от предыдущего значения этого же ряда и небольшой зависимости от второго значения. Данный ряд является нестационарным. Проверим это с помощью критерия Дики-Фуллера:</p>
						<p>Значение статистики <span class="math">t = 2.9249</span>. Критическое значение <span class="math">DFкр(0,01; 260) = -3,4565, p-value: 0.0425. Р-value > 0.01</span>, следовательно, ряд нестационарен. Перейдем к первым разностям: <span class="math">∇e(t) = e(t) - e(t - 1)</span>.</p>
						<p>Графики первой разности, автокорреляционной функции и частной автокорреляционной функции имеют вид:</p>
						<div class="plot" id="plot-first-difference"></div>
						<div class="plot" id="plot-autocorellation-2"></div>
						<div class="plot" id="plot-autocorellation-2"></div>
						<p>Вновь проверим гипотезу о стационарности: <span class="math">t = -5.7897, DFкр(0,01; 260) = -3,4565, p-value: 0.0. Р-value < 0.01</span>, следовательно, ряд первых разностей стационарен. Таким образом, порядок интегрирования <span class="math">k = 1</span>.</p>
						<p class="math">∇e(t) = α<sub>1</sub> * ∇e(t - 1) + α<sub>2</sub> * ∇e(t - 2) + ⋯ + α<sub>p</sub> * ∇e(t - p) + u(t) + β<sub>1</sub> * u(t - 1) + β<sub>2</sub> u(t - 2) + ⋯ + β<sub>q</sub> * u(t - q).</p>
					</li>
					<li>
						<h3>3. Построение ARMA-модели</h3>
						<p>Построим модель <span class="math">ARIMA(p, 1, q)</span>. Выбор в пользу той или иной модели будем делать на основе критерия Шварца (BIC) (для получения состоятельных оценок).</p>
						<p>Строить модель будем при <span class="math">p, q ∈ [0,10)</span>. Построение модели будем осуществлять с помощью метода ARIMA(…).fit() библиотеки statsmodels.tsa языка Python. Данный метод находит неизвестные оценки <span class="math">α<sub>1</sub>, α<sub>2</sub>, … , α<sub>p</sub>, β<sub>1</sub>, β<sub>2</sub>, … , β<sub>q</sub></span> с помощью метода максимального правдоподобия при использовании фильтра Калмана.</p>
						<p>Результаты построения модели для каждой пары значений <span class="math">p, q</span> представим в виде таблицы:</p>
						<table>
							<thead>
								<tr>
									<th class="math">(p, q)</th>
									<th>BIC</th>
									<th></th>
									<th class="math">(p, q)</th>
									<th>BIC</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
						<p>Таким образом получается модель <span class="math">ARIMA(1, 1, 0)</span> со следующим набором коэффициентов: <span class="math">α<sub>1</sub> = 0.3133, α<sub>2</sub> = 0.2973, α<sub>3</sub> = 0.2765</span>.</p>
					</li>
					<li>
						<h3>4. Анализ стационарности временного ряда полученных остатков</h3>
						<p>Проведем анализ стационарности временного ряда полученных остатков: <span class="math">t = -15.9791, DFкр(0,01; 258) = -3.4559, p-value: 0.0</span>. Полученный ряд остатков <strong>стационарен</strong>.</p>
						<p>Представим график оценки исходного временного ряда моделями до оценки случайной компоненты и после:</p>
						<div class="plot"></div>
						<p>Значения среднеквадратической ошибки до и после оценивания случайной компоненты соответственно: <span class="math">MSE = 27.1048, MSE = 0.1825</span>.</p>
					</li>
				</ol>
			</li>
			<li>
				<h2>Вывод</h2>
				<p>
					В ходе работы...
				</p>
				<p>					
					По приведенному графику и низкому значению ошибки можно утверждать о хорошей аппроксимации исходных данных построенной моделью:
				</p>
				<p class="math">x(t) = 19.794 + 0.0644t + S(t) + ARIMA(1, 1, 0)</p>
			</li>
		</ul>
	</main>

	<footer>
		<script src="core/plotly.min.js"></script>
		<script src="core/jquery.min.js"></script>
		<script src="js/main.js"></script>
	</footer>
</body>
</html>